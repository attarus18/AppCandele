<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Candle Calculator</title>
    
    <style>
        /* CSS: The part that handles style and appearance */
        
        body {
            background-color: #2c2c2c;
            color: #ffffff;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            position: relative; /* Needed for absolute positioning of the language switcher */
        }

        /* --- NEW: Language Switcher Styles --- */
        .language-switcher {
            position: absolute;
            top: 20px;
            right: 20px;
            display: flex;
            align-items: center;
        }

        .language-switcher label {
            margin-right: 10px;
            font-size: 0.9em;
        }

        .language-switcher select {
            background-color: #505050;
            color: #ffffff;
            border: 1px solid #555;
            border-radius: 5px;
            padding: 5px;
            cursor: pointer;
        }
        /* --- END NEW --- */

        .calcolatore-container {
            background-color: #3d3d3d;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.5);
            width: 90%;
            max-width: 450px;
        }

        h1 {
            text-align: center;
            color: #ffa500;
            margin-bottom: 25px;
        }

        .input-gruppo label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
        }

        .input-gruppo input,
        .input-gruppo select {
            width: 100%;
            padding: 10px;
            margin-bottom: 20px;
            border-radius: 8px;
            border: 1px solid #555;
            background-color: #505050;
            color: #ffffff;
            box-sizing: border-box;
        }

        .slider-container {
            margin-bottom: 20px;
        }
        
        .slider {
            width: 100%;
            cursor: pointer;
        }
        
        .slider-value {
            color: #ffa500;
            font-weight: bold;
        }

        .tasti-container {
            display: flex;
            justify-content: space-between;
            margin-top: 20px;
        }

        button {
            padding: 12px 20px;
            border: none;
            border-radius: 8px;
            background-color: #ffa500;
            color: #2c2c2c;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: background-color 0.3s;
            width: 48%;
        }
        
        button:hover {
            background-color: #ffc14d;
        }

        #risultato {
            margin-top: 25px;
            text-align: center;
            font-size: 1.1em;
            background-color: #2c2c2c;
            padding: 15px;
            border-radius: 8px;
            min-height: 50px; /* Ensures container doesn't jump around */
        }
    </style>
</head>
<body>
    <div class="language-switcher">
        <label for="languageSelector" data-lang-key="languageLabel">Language:</label>
        <select id="languageSelector">
            <option value="en">English</option>
            <option value="it">Italiano</option>
            <option value="es">Español</option>
            <option value="fr">Français</option>
            <option value="de">Deutsch</option>
        </select>
    </div>

    <div class="calcolatore-container">
        <h1 data-lang-key="title">Candle Calculator</h1>
        <div class="input-gruppo">
            <label for="grammiCera" data-lang-key="finalWeightLabel">Desired final weight (grams):</label>
            <input type="number" id="grammiCera" data-lang-key-placeholder="weightPlaceholder">
        </div>
        <div class="input-gruppo">
            <label for="tipoCera" data-lang-key="waxTypeLabel">Type of wax:</label>
            <select id="tipoCera">
                <option value="soia" data-lang-key="soyWax">Soy</option>
                <option value="paraffina" data-lang-key="paraffinWax">Paraffin</option>
                <option value="cocco" data-lang-key="coconutWax">Coconut</option>
            </select>
        </div>
        <div class="slider-container">
            <label for="percFragranza"><span data-lang-key="fragrancePercentageLabel">Fragrance percentage:</span> <span id="valoreFragranza" class="slider-value">5%</span></label>
            <input type="range" id="percFragranza" class="slider" min="1" max="35" value="5">
        </div>
        <div class="slider-container">
            <label for="percColore"><span data-lang-key="colorPercentageLabel">Color percentage:</span> <span id="valoreColore" class="slider-value">1%</span></label>
            <input type="range" id="percColore" class="slider" min="0" max="25" value="1" step="0.1">
        </div>
        <div class="tasti-container">
            <button id="calcola" data-lang-key="calculateButton">Calculate</button>
            <button id="reset" data-lang-key="resetButton">Reset</button>
        </div>
        <div id="risultato"></div>
    </div>
    
    <script>
        // --- NEW: Translations Object ---
        const translations = {
            en: {
                title: "Candle Calculator",
                languageLabel: "Language:",
                finalWeightLabel: "Desired final weight (grams):",
                weightPlaceholder: "E.g., 100",
                waxTypeLabel: "Type of wax:",
                soyWax: "Soy",
                paraffinWax: "Paraffin",
                coconutWax: "Coconut",
                fragrancePercentageLabel: "Fragrance percentage:",
                colorPercentageLabel: "Color percentage:",
                calculateButton: "Calculate",
                resetButton: "Reset",
                invalidWeightError: "Please enter a valid final weight.",
                resultText: `To get a candle of <strong>{pesoTotale}g</strong>, you will need:<br>
                             <strong>{grammiCera}g</strong> of wax<br>
                             <strong>{grammiFragranza}g</strong> of fragrance<br>
                             <strong>{grammiColore}g</strong> of colorant`
            },
            it: {
                title: "Calcolatore Candele",
                languageLabel: "Lingua:",
                finalWeightLabel: "Peso finale desiderato (grammi):",
                weightPlaceholder: "Es. 100",
                waxTypeLabel: "Tipo di cera:",
                soyWax: "Soia",
                paraffinWax: "Paraffina",
                coconutWax: "Cocco",
                fragrancePercentageLabel: "Percentuale di fragranza:",
                colorPercentageLabel: "Percentuale di colore:",
                calculateButton: "Calcola",
                resetButton: "Reset",
                invalidWeightError: "Per favore, inserisci un peso finale valido.",
                resultText: `Per ottenere una candela da <strong>{pesoTotale} gr</strong>, avrai bisogno di:<br>
                             <strong>{grammiCera} gr</strong> di cera<br>
                             <strong>{grammiFragranza} gr</strong> di fragranza<br>
                             <strong>{grammiColore} gr</strong> di colorante`
            },
            es: {
                title: "Calculadora de Velas",
                languageLabel: "Idioma:",
                finalWeightLabel: "Peso final deseado (gramos):",
                weightPlaceholder: "Ej. 100",
                waxTypeLabel: "Tipo de cera:",
                soyWax: "Soja",
                paraffinWax: "Parafina",
                coconutWax: "Coco",
                fragrancePercentageLabel: "Porcentaje de fragancia:",
                colorPercentageLabel: "Porcentaje de color:",
                calculateButton: "Calcular",
                resetButton: "Reiniciar",
                invalidWeightError: "Por favor, ingrese un peso final válido.",
                resultText: `Para obtener una vela de <strong>{pesoTotale}g</strong>, necesitarás:<br>
                             <strong>{grammiCera}g</strong> de cera<br>
                             <strong>{grammiFragranza}g</strong> de fragancia<br>
                             <strong>{grammiColore}g</strong> de colorante`
            },
            fr: {
                title: "Calculateur de Bougies",
                languageLabel: "Langue:",
                finalWeightLabel: "Poids final souhaité (grammes):",
                weightPlaceholder: "Ex. 100",
                waxTypeLabel: "Type de cire:",
                soyWax: "Soja",
                paraffinWax: "Paraffine",
                coconutWax: "Noix de coco",
                fragrancePercentageLabel: "Pourcentage de parfum:",
                colorPercentageLabel: "Pourcentage de couleur:",
                calculateButton: "Calculer",
                resetButton: "Réinitialiser",
                invalidWeightError: "Veuillez entrer un poids final valide.",
                resultText: `Pour obtenir une bougie de <strong>{pesoTotale}g</strong>, vous aurez besoin de:<br>
                             <strong>{grammi
